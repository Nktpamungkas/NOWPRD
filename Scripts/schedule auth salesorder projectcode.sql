INSERT INTO PROJECT (
    COMPANYCODE,
    DIVISIONCODE,
    ALLOWEDDIVISIONS,
    CODE,
    LONGDESCRIPTION,
    SHORTDESCRIPTION,
    SEARCHDESCRIPTION,
    CUSTOMERTYPE,
    CUSTOMERCODE,
    BUDGETMANAGED,
    BUDGETPROGRESSSTATUS,
    BUDGETSTATUS,
    BUDGETAPPROVALDATE,
    BUDGETAPPROVALUSER,
    PLANNERANNOTATION,
    PLANRUNNING,
    CANBEEXPLODED,
    PLANNINGTEMPLATECODE,
    PROGRESSSTATUS,
    LINESCHANGED,
    ERRORS,
    WARNINGS,
    TRACECREATIONID,
    TRACELINE,
    SUBMITTEDJOBJOBNUMBER,
    CREATIONDATETIME,
    CREATIONUSER,
    LASTUPDATEDATETIME,
    LASTUPDATEUSER,
    CREATIONDATETIMEUTC,
    LASTUPDATEDATETIMEUTC,
    OWNINGCOMPANYCODE,
    ABSUNIQUEID
)
SELECT 
	COMPANYCODE, 
	NULL AS DIVISIONCODE, 
	NULL AS ALLOWEDDIVISIONS,
	CODE,
	CODE AS LONGDESCRIPTION,
	CODE AS SHORTDESCRIPTION,
	CODE AS SEARCHDESCRIPTION,
	1 AS CUSTOMERTYPE,
	NULL AS CUSTOMERCODE,
	0 AS BUDGETMANAGED,
    0 AS BUDGETPROGRESSSTATUS,
    0 AS BUDGETSTATUS,
    NULL AS BUDGETAPPROVALDATE,
    NULL AS BUDGETAPPROVALUSER,
    NULL AS PLANNERANNOTATION,
    0 AS PLANRUNNING,
    0 AS CANBEEXPLODED,
    NULL AS PLANNINGTEMPLATECODE,
    0 AS PROGRESSSTATUS,
    0 AS LINESCHANGED,
    NULL AS ERRORS,
    NULL AS WARNINGS,
    NULL AS TRACECREATIONID,
    0 AS TRACELINE,
    0 AS SUBMITTEDJOBJOBNUMBER,
    CREATIONDATETIME AS CREATIONDATETIME,
    CREATIONUSER AS CREATIONUSER,
    NULL AS LASTUPDATEDATETIME,
    NULL AS LASTUPDATEUSER,
    CREATIONDATETIMEUTC AS CREATIONDATETIMEUTC,
    NULL AS LASTUPDATEDATETIMEUTC,
    NULL AS OWNINGCOMPANYCODE,
    0 AS ABSUNIQUEID
FROM
	SALESORDER s 
WHERE 
	PROJECTCODE IS NULL AND CREATIONDATETIME > '2024-07-01'
	AND NOT EXISTS (
	    SELECT 1 
	    FROM PROJECT p 
	    WHERE p.CODE = s.CODE
	  )